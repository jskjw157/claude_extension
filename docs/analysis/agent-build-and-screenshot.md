# 에이전트 분석: build-and-screenshot

## 1. 에이전트 개요
- **이름**: `build-and-screenshot`
- **목적**: 컴포넌트 메타데이터를 검증 및 빌드하고, Docker 환경을 활용하여 프로덕션 서버를 띄운 후 스크린샷을 자동으로 캡처하는 CI/CD 자동화 에이전트입니다.
- **역할**: "Build and deployment specialist"로 정의되며, 메타데이터 무결성 검사부터 시각적 결과물 생성까지의 파이프라인을 책임집니다.

## 2. 프롬프트 구조 분석

### 2.1 자가 치유(Self-Healing) 매커니즘
이 에이전트의 가장 독특한 특징은 단순 실행을 넘어 오류 발생 시 **스스로 수정(Auto-Fix)**을 시도한다는 점입니다.
- **Reference Files**: 수정 시 참고할 소스 코드(`src/types/*.ts`)와 스크립트 위치를 명시.
- **Valid Values Reference**: 카테고리, 태그 등의 유효한 값 목록을 프롬프트 내에 직접 포함하여, AI가 올바른 값으로 수정할 수 있도록 지식 베이스를 제공합니다.
- **Error Auto-Fix Guide**: 
    - 오류 유형별 해결 방법(Fix Method)을 테이블로 매핑.
    - 구체적인 수정 프로세스(에러 파싱 -> 파일 읽기 -> 수정 -> 재검증) 정의.
    - 최대 3회 재시도라는 종료 조건(Exit Condition) 명시.

### 2.2 하이브리드 실행 환경 (Local + Docker)
- **Step 1 & 2 (Local)**: 메타데이터 검증 및 빌드는 로컬 `pnpm` 명령어로 빠르게 수행하여 피드백 루프를 단축합니다.
- **Step 3~6 (Docker)**: 환경 일관성이 중요한 빌드, 서버 실행, 스크린샷 캡처는 Docker 컨테이너 내부에서 수행하도록 설계되었습니다.
    - 호스트 환경 오염 방지 및 실행 환경의 재현성 보장.
    - `pnpm docker:screenshot:*` 스크립트로 복잡한 Docker 명령어를 추상화.

### 2.3 구조화된 출력 및 에러 핸들링
- **Output Format**: 각 단계(Step 1~6)의 성공/실패 여부를 명확한 리포트 형식으로 출력하도록 강제합니다. 이는 오케스트레이터나 사용자가 결과를 쉽게 파악하게 돕습니다.
- **Input Parameters**: 전체 빌드와 증분 빌드(incremental)를 구분하여 효율성을 고려했습니다.

## 3. 핵심 시사점 (Best Practices)
1.  **Context-Aware Error Handling**:
    - 단순히 "에러가 났다"고 보고하는 것이 아니라, "Category enum error"가 발생하면 "Valid Values Reference"를 참조하여 "hero"로 수정하는 식의 지능적 복구 로직이 포함되어 있습니다.
    - 이는 에이전트의 자율성을 극대화하는 훌륭한 패턴입니다.

2.  **환경 격리 전략**:
    - 브라우저 실행(Playwright 등)과 같은 무거운 작업이나 시스템 의존적인 작업을 Docker로 격리하여, 에이전트가 실행되는 로컬 환경(Windows/Mac/Linux)의 차이로 인한 문제를 원천 차단했습니다.

3.  **참조 데이터의 인라인 포함**:
    - 자주 참조하는 Enum 값(카테고리, 태그 등)을 별도 파일 읽기 없이 프롬프트에 직접 포함시켜, 토큰 비용은 다소 증가하지만 처리 속도와 정확도를 높였습니다.
